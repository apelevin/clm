# Функциональные возможности сервиса анализа договоров

## Обзор

Сервис автоматически анализирует текст договора с использованием искусственного интеллекта и извлекает структурированную информацию, помогая пользователям быстро понять суть договора, свои права и обязанности, а также возможные действия.

---

## 1. Загрузка и обработка договоров

### Загрузка текста договора
- **Ввод текста вручную** — возможность вставить текст договора напрямую в текстовое поле
- **Загрузка файла** — поддержка загрузки текстовых файлов формата `.txt` (до 300 КБ)
- **Валидация входных данных** — проверка наличия текста и ограничение размера файла

### Обработка договора
- **Автоматический парсинг** — анализ текста договора с использованием OpenAI API
- **Параллельная обработка** — оптимизированный парсинг для ускорения обработки больших документов
- **Прогресс-бар** — визуальная индикация этапов обработки (4 этапа)
- **Обработка ошибок** — информативные сообщения об ошибках при обработке

---

## 2. Извлечение основной информации о договоре

Система автоматически извлекает ключевые данные:

- **Номер договора** — идентификационный номер документа
- **Дата заключения** — дата подписания договора
- **Место заключения** — город, где был заключен договор
- **Стороны договора**:
  - Заказчик (полное и краткое наименование)
  - Исполнитель (полное и краткое наименование)
- **Сумма договора** — общая стоимость с указанием валюты
- **Предмет договора** — краткое описание того, что является предметом договора (услуги, работы, товары)

---

## 3. Извлечение ключевых положений договора

### Категории положений
Система автоматически выделяет важные условия договора и группирует их по категориям:

- **Сроки** — дедлайны, периоды выполнения, даты
- **Оплата** — условия оплаты, суммы, графики платежей
- **Ответственность** — штрафы, пени, неустойки, возмещение ущерба
- **Гарантии** — гарантийные обязательства, обеспечение исполнения
- **Приемка** — условия приемки работ, подписания актов
- **Расторжение** — условия расторжения договора
- **Форс-мажор** — обстоятельства непреодолимой силы
- **Конфиденциальность** — условия неразглашения информации
- **Разрешение споров** — порядок урегулирования конфликтов
- **Изменение договора** — процедуры внесения изменений
- **Интеллектуальная собственность** — права на результаты интеллектуальной деятельности
- **Электронный документооборот** — условия работы с электронными документами
- **Прочие условия** — другие важные положения

### Информация о каждом положении
- **Заголовок** — краткое название положения
- **Содержание** — суть условия
- **Категория** — к какой группе относится положение
- **Для кого** — заказчик, исполнитель или обе стороны
- **Приоритет** — основные или второстепенные положения
- **Связанные пункты договора** — ссылки на конкретные разделы договора
- **Источник в тексте** — возможность посмотреть оригинальный текст

---

## 4. Финансовые обязательства

### Детальная информация о платежах
Для каждого финансового обязательства система извлекает:

- **Кто платит** — заказчик или исполнитель
- **Кому платит** — заказчику или исполнителю
- **За что платит** — назначение платежа (оплата услуг, предоплата, штраф и т.д.)
- **Сумма** — может быть:
  - Фиксированная сумма (например, 1 000 000 рублей)
  - Процент (например, 10% от суммы договора)
  - Рассчитываемая по формуле (например, 0.1% за каждый день просрочки)
- **График платежей** — может быть:
  - Разовый платеж (одна дата)
  - Рассрочка (несколько платежей с указанием сумм и сроков)
  - По этапам (платежи при достижении определенных этапов)
  - Периодические платежи (ежемесячно, ежеквартально и т.д.)
- **Условия оплаты** — предоплата, постоплата, гарантии, залог и т.д.
- **Связанные пункты договора** — ссылки на разделы договора
- **Источник в тексте** — возможность посмотреть оригинальный текст

### Группировка обязательств
- Обязательства заказчика (что должен заплатить заказчик)
- Обязательства исполнителя (что должен заплатить исполнитель)

---

## 5. Состояния договора

### Определение состояний
Система определяет возможные состояния, в которых может находиться договор:

- **Проект договора** — договор находится в стадии подготовки/согласования (состояние по умолчанию)
- **Договор выполняется** — активное выполнение работ
- **Просрочен контракт** — нарушены сроки выполнения
- **Уступлены обязательства** — передача прав и обязанностей третьим лицам
- **Приостановлен** — временная остановка выполнения
- **Расторгнут** — договор прекращен
- **На стадии приемки** — процесс приемки выполненных работ
- **Ожидается оплата** — ожидание платежа от стороны
- **Требуется устранение недостатков** — необходимо исправление выявленных проблем

### Информация о состоянии
- **Название состояния** — краткое описание
- **Описание** — детальное объяснение состояния (микро-подпись для выпадающего списка)
- **Дата наступления стадии** — возможность указать дату начала состояния
- **Задачи в состоянии** — список задач, которые должны быть выполнены в этом состоянии
- **Источник в тексте** — возможность посмотреть, где в договоре это описано

### Фильтрация по состояниям
- При выборе состояния система автоматически фильтрует действия и обязательства
- Показываются только те элементы, которые релевантны текущей ситуации
- Выбранные состояния сохраняются в сессии браузера

---

## 6. Задачи и действия по состояниям

### Задачи в состояниях
Для каждого состояния система определяет задачи, которые должны быть выполнены:

- **Название задачи** — что нужно сделать (например: "Оплатить предоплату", "Предоставить техническое задание")
- **Описание** — детальное описание задачи (опционально)
- **Кто должен выполнить** — заказчик, исполнитель или обе стороны
- **Приоритет** — основные или второстепенные задачи
- **Срок выполнения** — относительная дата выполнения задачи:
  - Количество дней (календарные или рабочие)
  - Направление (до или после наступления стадии)
  - Текстовое описание (например: "через 5 дней", "не позднее 3 рабочих дней")
- **Расчет даты выполнения** — автоматический расчет конкретной даты на основе даты наступления стадии
- **Индикация просрочки** — визуальное выделение просроченных задач
- **Индикация приближающихся сроков** — предупреждение о приближающихся дедлайнах
- **Источник в тексте** — возможность посмотреть оригинальный текст

---

## 7. Анализ рисков положений договора

### Глубокий анализ рисков
Для каждого ключевого положения можно провести анализ рисков:

#### Краткое резюме
- Одна строка с уровнем риска и основной причиной
- Пример: "Риск: Средний. Причина: неопределённость условий приостановления"

#### Индикаторы риска
- **Уровень риска** — низкий, средний, высокий
- **Тип риска**:
  - Неопределённость — неясность формулировок
  - Дисбаланс — неравновесие интересов сторон
  - Неправомерность — потенциально незаконные условия
  - Процедурный — проблемы с процедурами
- **Вероятность спора** — процент вероятности спора (0-100)
- **Сложность последствий** — легкие, средние, критичные

#### Юридическая карта риска
- **Проблемные элементы** — описание проблемных элементов формулировки и в чем конкретно проблема
- **Последствия** — что может случиться, кому риск, вероятность
- **AI-оценка вероятности конфликта** — общая оценка вероятности конфликта (0-100)

#### Impact-анализ
- **Если оставить как есть** — последствия при сохранении текущей формулировки
- **Если исправить** — последствия при использовании рекомендованной формулировки

#### Рекомендованная формулировка
- Альтернативная формулировка условия на русском языке
- Лучшая защита интересов заказчика
- Соответствие деловому юридическому стилю
- Краткие отличия от исходной формулировки

#### Benchmark сравнение
- Сравнение с рыночными стандартами для категории обязательства
- Элементы для сравнения (например: "Уведомление", "Пропорциональность")
- Статус в исходном тексте (присутствует, отсутствует, частично)
- Процент соответствия рыночному стандарту (0-100)
- Описание стандарта и рекомендации

#### Мини-таймлайн событий
- Извлечение всех дат, сроков, периодов из текста
- Последовательность событий с днями относительно начала
- Описание каждого события

#### Граф зависимостей (опционально)
- Анализ связей между обязательствами
- Узлы графа (обязательства)
- Связи между обязательствами (активирует, влияет на, приводить к)

### Кэширование результатов анализа
- Результаты анализа рисков кэшируются на 24 часа
- Повторный анализ того же положения возвращает закэшированный результат

---

## 8. Фильтрация и поиск

### Фильтр по категориям обязательств
- Выбор конкретной категории (например, только "Оплата" или только "Сроки")
- Система показывает только положения из выбранной категории
- Возможность сбросить фильтр

### Фильтр по сторонам
- Выбор, для кого показывать обязательства:
  - Заказчик
  - Исполнитель
  - Обе стороны
- Работает в сочетании с фильтром по категориям
- Если все фильтры сняты, автоматически включаются все стороны

### Фильтр по состояниям
- При выборе состояний договора автоматически фильтруются действия и обязательства
- Показываются только те элементы, которые релевантны выбранным состояниям
- Для состояния "Проект договора" показываются все обязательства

### Комбинированная фильтрация
- Все фильтры работают совместно
- Можно одновременно применять фильтры по категориям, сторонам и состояниям

---

## 9. Связь с оригинальным текстом

### Просмотр источников
Для каждого элемента (действие, положение, обязательство, состояние) есть возможность:

- **Показать источник в тексте** — система подсветит соответствующие параграфы в оригинальном тексте договора
- **Связанные пункты договора** — ссылки на конкретные разделы и подразделы
- **Прокрутка к источнику** — автоматическая прокрутка к первому параграфу источника

### Просмотр договора
- **Двухколоночный интерфейс** — левая колонка с интерфейсом, правая с оригинальным текстом
- **Возможность скрыть текст** — переключение видимости текста договора
- **Подсветка параграфов** — визуальное выделение релевантных параграфов при клике на "Показать источник"

---

## 10. Интерфейс и навигация

### Структура интерфейса
- **Заголовок** — название договора и переключение видимости текста
- **Основные разделы**:
  1. Договор — основная информация
  2. Стороны — информация о сторонах договора
  3. Состояние — выбор текущего состояния договора
  4. Предмет — описание предмета договора
  5. Финансы — финансовые обязательства
  6. Обязательства — ключевые положения договора
  7. Согласование — функционал согласования (в разработке)

### Адаптивность
- Адаптивный дизайн для различных размеров экранов
- Оптимизация для мобильных устройств, планшетов и десктопов

### Сохранение состояния
- Выбранное состояние договора сохраняется в sessionStorage
- При перезагрузке страницы состояние восстанавливается

---

## 11. Технические возможности

### Параллельная обработка
- Оптимизированный парсинг для ускорения обработки больших документов
- Разделение текста на секции для параллельной обработки
- Автоматическое объединение результатов

### Валидация данных
- Проверка корректности извлеченных данных
- Автоматическое исправление некорректных категорий
- Нормализация данных для единообразия

### Обработка ошибок
- Информативные сообщения об ошибках
- Обработка ошибок API
- Fallback на альтернативные методы обработки

### Метрики и логирование
- Сбор метрик использования API
- Логирование времени обработки
- Отслеживание использования токенов

### Кэширование
- Кэширование результатов анализа рисков
- Оптимизация повторных запросов

---

## 12. Ограничения и особенности

### Ограничения
- Максимальный размер текста договора: 300 КБ
- Поддерживаются только текстовые файлы формата `.txt`
- Результаты сохраняются в sessionStorage (ограничение размера ~5-10 МБ)

### Особенности работы
- Анализ происходит автоматически при загрузке документа
- Результаты сохраняются в сессии браузера
- Система работает с текстовыми файлами и прямым вводом текста
- Используется искусственный интеллект для анализа текста договора

---

## 13. Преимущества для пользователя

- **Экономия времени** — не нужно читать весь договор целиком, система уже выделила самое важное
- **Структурированность** — вся информация организована по категориям и типам
- **Актуальность** — можно фильтровать информацию по текущей ситуации
- **Прозрачность** — всегда видно источник информации в оригинальном тексте
- **Удобство** — все действия и обязательства представлены в понятном виде
- **Ориентация на заказчика** — интерфейс показывает информацию с точки зрения заказчика, выделяя его действия и обязательства
- **Анализ рисков** — глубокий анализ рисков каждого положения с рекомендациями
- **Контроль сроков** — автоматический расчет дат выполнения задач и индикация просрочек

---

## 14. Примеры использования

### Сценарий 1: Новый договор
Пользователь загружает договор и сразу видит:
- Основную информацию (номер, дата, стороны, сумма)
- Предмет договора
- Все свои действия (что можно сделать)
- Финансовые обязательства (сколько и когда платить)
- Ключевые условия (сроки, ответственность и т.д.)

### Сценарий 2: Контроль выполнения
Пользователь отмечает состояние "Договор выполняется" и видит:
- Только актуальные действия (например, "Оплатить услуги", "Рассмотреть материалы")
- Только релевантные обязательства
- Задачи с рассчитанными датами выполнения
- Не видит информацию о расторжении или форс-мажоре (если они не актуальны)

### Сценарий 3: Поиск конкретной информации
Пользователь выбирает фильтр "Оплата" и видит:
- Все положения, связанные с оплатой
- Все финансовые обязательства
- Все действия, связанные с оплатой

### Сценарий 4: Анализ рисков
Пользователь нажимает "Проанализировать риски" на конкретном положении и получает:
- Оценку уровня риска
- Детальный анализ проблемных элементов
- Рекомендованную формулировку
- Сравнение с рыночными стандартами
- Таймлайн событий

---

## 15. Планируемые функции

### В разработке
- **Согласование** — функционал согласования договоров (раздел "Согласование" помечен как "в разработке")

